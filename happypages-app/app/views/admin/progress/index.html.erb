<%= render "admin/shared/tabs" %>

<div class="min-h-screen bg-[#f9f9f9] py-8">
  <div class="max-w-4xl mx-auto px-4">
    <header class="mb-8 flex justify-between items-start">
      <div>
        <h1 class="text-3xl font-bold text-gray-900 text-balance">Project Progress</h1>
        <p class="text-gray-600 mt-2 text-pretty">Timeline of milestones and achievements</p>
      </div>
    </header>

    <%# Key Milestones - Horizontal Scrolling Cards %>
    <% if @key_milestones.present? %>
      <div class="mb-8">
        <h2 class="text-sm font-semibold text-gray-500 uppercase mb-4">Key Milestones</h2>
        <div class="overflow-x-auto -mx-4 px-4">
          <div class="flex gap-4 pb-2" style="min-width: max-content;">
            <% milestone_icons = ["ðŸš€", "âš¡", "ðŸ”—", "ðŸŽ¨", "âœ¨", "ðŸ”§", "ðŸ“Š", "ðŸ—ï¸", "ðŸ”"] %>
            <% @key_milestones.each_with_index do |milestone, i| %>
              <div class="flex-shrink-0 w-36 bg-white rounded-xl p-4 border border-black/5 shadow-sm hover:shadow-md transition-shadow cursor-default">
                <div class="text-2xl mb-2"><%= milestone_icons[i % milestone_icons.size] %></div>
                <p class="text-xs font-medium text-[#ff584d] mb-1"><%= milestone[:date] %></p>
                <p class="text-sm font-semibold text-gray-900 leading-tight"><%= milestone[:title] %></p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>

    <%# Compact Timeline %>
    <div class="bg-[#f4f4f0] rounded-xl border border-black/5 shadow-[inset_1px_1px_0_rgba(255,255,255,1),inset_-1px_-1px_0_rgba(0,0,0,0.05),0_4px_8px_rgba(0,0,0,0.05)] overflow-hidden">
      <div class="p-6">
        <% if @weeks.present? %>
          <div class="space-y-4">
            <% @weeks.each do |week, items| %>
              <% next unless week %>
              <details class="group" open>
                <summary class="cursor-pointer text-base font-semibold text-gray-900 flex items-center gap-2 py-2 px-3 bg-white rounded-lg shadow-sm border border-black/5 hover:bg-gray-50 transition-colors list-none [&::-webkit-details-marker]:hidden">
                  <svg class="size-4 text-[#ff584d] transition-transform group-open:rotate-90 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                  <span class="flex-1"><%= week[:title] %></span>
                  <span class="text-xs font-normal text-gray-400"><%= week[:dates] %></span>
                  <span class="text-xs bg-[#ff584d]/10 text-[#ff584d] px-2 py-0.5 rounded-full font-medium"><%= items.size %> items</span>
                </summary>
                <div class="ml-4 mt-2 pl-4 border-l-2 border-[#ff584d]/30 space-y-1">
                  <% items.each do |milestone| %>
                    <div class="flex items-start gap-2 py-2 group/item hover:bg-white/80 rounded-lg px-3 -mx-1 transition-colors cursor-default">
                      <div class="size-2 bg-[#ff584d] rounded-full mt-1.5 flex-shrink-0 group-hover/item:scale-125 transition-transform"></div>
                      <div class="flex-1 min-w-0">
                        <span class="text-xs text-[#ff584d] font-bold"><%= milestone[:date] %></span>
                        <span class="text-gray-400 mx-1.5">â€”</span>
                        <span class="text-sm text-gray-700"><%= milestone[:description] %></span>
                      </div>
                    </div>
                  <% end %>
                </div>
              </details>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-12 text-gray-500">
            <p>No milestones found in HISTORY.md</p>
            <p class="text-sm mt-2">Run <code class="bg-gray-100 px-2 py-1 rounded">doc-checkpoint</code> to populate the timeline.</p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
