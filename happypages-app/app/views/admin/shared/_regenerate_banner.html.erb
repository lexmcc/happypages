<%# Regenerate imagery card â€” include in referral page and thank-you card editors
    Locals: surface ("referral_banner" or "extension_card") %>

<% shop = Current.shop %>
<div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border border-indigo-100 p-5">
  <div class="flex items-center justify-between">
    <div>
      <h3 class="text-sm font-semibold text-gray-900 flex items-center gap-2">
        <svg class="size-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.455 2.456L21.75 6l-1.036.259a3.375 3.375 0 00-2.455 2.456z"></path>
        </svg>
        AI-Generated Imagery
      </h3>
      <p class="text-xs text-gray-500 mt-1">
        <% if shop.brand_scraped? %>
          Generate on-brand imagery using your store's colors, products, and style.
        <% else %>
          We'll analyze your store's brand identity first, then generate imagery.
        <% end %>
      </p>
    </div>

    <div class="flex items-center gap-3">
      <span class="text-xs text-gray-500">
        <strong><%= shop.generation_credits_remaining.to_i %></strong> of 10 credits
      </span>

      <%= button_to admin_image_generations_path, params: { surface: surface },
          method: :post,
          class: "px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",
          disabled: !shop.can_generate? do %>
        <svg class="size-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182"></path>
        </svg>
        <% if shop.brand_scraped? %>
          Regenerate
        <% else %>
          Generate
        <% end %>
      <% end %>
    </div>
  </div>
</div>
